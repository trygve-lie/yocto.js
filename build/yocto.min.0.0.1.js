(function(t){"use strict";function n(t){function n(t,n){t.template={},t.object=void 0,t.index=0,t.match=!1,t.onEach=void 0,t.result=[],t.onEnd=void 0,n=[]}function e(){var t=arguments;return function(){var n=0,e=t.length,r=arguments;for(n=0;e>n;n+=1)r=[t[n].apply(this,r)];return r[0]}}function r(t){return t.match=Object.keys(t.template).every(function(n){return m.fn(t.template[n])?t.template[n].call(this,t.object[n],m):t.object[n]===t.template[n]}),t}function u(t){return t.match&&(t.object=t.objects.splice(t.index,1)[0],t.index--),t}function o(t){var n=t.template[f.uuid];return delete t.uuids[n],t}function i(t){return t.match&&t.onEach.call(null,t.object),t}function c(t,n){var r=e.apply(null,n),u=0!==t.result.length||!1,o=u?t.result:t.objects,i=[],c=o.length;for(t.index=0;c>t.index;t.index+=1)t.object=o[t.index],r(t),t.match&&(u||c==o.length||(c=o.length),i.push(t.object));return t.result=i,t.onEnd&&t.onEnd.call(null,t.result),t}function s(t,n){var r=e.apply(null,n),u=t.template[f.uuid];return t.object=t.uuids[u],r(t),t.match&&t.result.push(t.object),t.onEnd&&t.onEnd.call(null,t.result),t}function a(t,n){return f.uuid&&t.template[f.uuid]?s(t,n):c(t,n)}function l(t){return t&&"session"===t.type?"sessionStorage":"localStorage"}var f={name:"yocto"},d=[],h={objects:[],uuids:{},template:{},object:void 0,index:0,match:!1,onEach:void 0,result:[],onEnd:void 0},p={storage:function(){var t="__ytest";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(n){return!1}}},m={arr:function(t){return t instanceof Array},obj:function(t){return t instanceof Object},fn:function(t){return"function"==typeof t},str:function(t){return"string"==typeof t},num:function(t){return"number"==typeof t},empty:function(t){return null===t?!0:m.arr(t)||m.str(t)?0===t.length:m.obj(t)?0===Object.keys(t).length:!0}};return m.obj(t)&&m.obj(f)&&Object.keys(t).every(function(n){"name"!==n&&(f[n]=t[n])}),{put:function(t,n){var e="",r=0,u=0;if(h.match=!0,m.arr(t)&&(t=t.filter(function(t){return m.obj(t)&&!m.arr(t)}),h.objects=h.objects.concat(t),h.result=h.result.concat(t),f.uuid))for(u=t.length,r=0;u>r;r+=1)e=t[r][f.uuid],h.uuids[t[r][f.uuid]]=t[r];return m.obj(t)&&!m.arr(t)&&(h.objects.push(t),h.result.push(t),f.uuid&&(e=t[f.uuid],h.uuids[t[f.uuid]]=t)),n&&m.fn(n)&&(n.call(this,h.result),h.result=[]),this},get:function(t,e){return h.template=t||{},d.push(r),h.onEnd=e,e&&m.fn(e)&&(a(h,d),n(h),d=[]),this},take:function(t,e){return h.template=t||{},d.push(r),d.push(u),d.push(o),h.onEnd=e,e&&m.fn(e)&&(c(h,d),n(h),d=[]),this},each:function(t){return d.push(i),h.onEach=t,t&&m.fn(t)&&(a(h,d),n(h),d=[]),this},drop:function(t){return h.objects.splice(0,h.objects.length),h.uuids={},t&&m.fn(t)&&(t.call(null),n(h),d=[]),this},destroy:function(t,n){var e=l(t);return t&&m.str(t.name)&&p.storage()&&window[e].removeItem(t.name),this.drop(n),this},sort:function(t,e){return h.onEnd=function(){h.result=h.result.sort(function(n,e){var r="",u="";if(m.obj(n)&&m.obj(e)&&n&&e){if(r=n[t],u=e[t],r===u)return n;if(typeof r==typeof u)return u>r?-1:1}}),e&&m.fn(e)&&e.call(null,h.result)},e&&m.fn(e)&&(a(h,d),n(h,d),d=[]),this},save:function(t,e){var r=l(t);return t&&m.str(t.name)&&p.storage()&&(h.onEnd=function(){window[r].setItem(t.name,JSON.stringify({creator:t.name,timestamp:+new Date,objects:h.result})),e&&m.fn(e)&&e.call(null,h.result)},e&&m.fn(e)&&(a(h,d),n(h,d),d=[])),this},load:function(t,n){var e=l(t),r="",u={};return t&&m.str(t.name)&&p.storage()&&(r=window[e].getItem(t.name),u=JSON.parse(r)),this.put(m.empty(u)?[]:u.objects,n),this}}}t.db=function(t){return new n(t)}})("undefined"==typeof exports?this.yocto={}:exports);
//@ sourceMappingURL=build/yocto.min.0.0.1.js.map