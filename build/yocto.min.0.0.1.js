(function(t){"use strict";function n(t){function n(){var t="__ytest";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(n){return!1}}function e(t){t.template={},t.doHashLookup=!1,t.object=void 0,t.index=0,t.match=!1,t.onEach=void 0,t.result=[],t.onEnd=void 0}function u(){var t=arguments;return function(){var n=0,e=t.length,u=arguments;for(n=0;e>n;n+=1)u=[t[n].apply(this,u)];return u[0]}}function r(t){return t.match=Object.keys(t.template).every(function(n){return g.fn(t.template[n])?t.template[n].call(this,t.object[n],g):t.object[n]===t.template[n]}),t}function o(t){return t.match&&(t.object=t.objects.splice(t.index,1)[0],t.index--),t}function i(t){var n=t.template[h.uuid];return delete t.uuids[n],t}function s(t,n,e){return t.uuid&&(e.uuids[n[t.uuid]]=n),e}function c(t){return t.match&&t.onEach.call(null,t.object),t}function a(t,n){var e=u.apply(null,n),r=0!==t.result.length||!1,o=r?t.result:t.objects,i=[],s=o.length;for(t.index=0;s>t.index;t.index+=1)t.object=o[t.index],e(t),t.match&&(r||s==o.length||(s=o.length),i.push(t.object));return t.result=i,t.onEnd&&t.onEnd.call(null,t.result),t}function l(t,n){var e=u.apply(null,n),r=t.template[h.uuid];return t.object=t.uuids[r]?t.uuids[r]:{},e(t),t.match&&t.result.push(t.object),t.onEnd&&t.onEnd.call(null,t.result),t}function f(t,n){return h.uuid&&t.template[h.uuid]&&t.doHashLookup?l(t,n):a(t,n)}function d(t){return t&&"session"===t.type?"sessionStorage":"localStorage"}function p(t,n,e){t.timestamp&&!n[t.timestamp]&&(n[t.timestamp]=e.updated)}var h={name:"yocto"},m=[],b={objects:[],uuids:{},updated:-1,template:{},doHashLookup:!1,object:void 0,index:0,match:!1,onEach:void 0,result:[],onEnd:void 0},j={storage:n()},g={arr:function(t){return t instanceof Array},obj:function(t){return t instanceof Object},fn:function(t){return"function"==typeof t},str:function(t){return"string"==typeof t},num:function(t){return"number"==typeof t},empty:function(t){return null===t?!0:g.arr(t)||g.str(t)?0===t.length:g.obj(t)?0===Object.keys(t).length:!0}};return g.obj(t)&&g.obj(h)&&Object.keys(t).every(function(n){"name"!==n&&(h[n]=t[n])}),{put:function(t,n){var u=0,r=0;if(b.match=!0,b.updated=+new Date,g.arr(t)){if(t=t.filter(function(t){return g.obj(t)&&!g.arr(t)}),h.uuid||h.timestamp)for(r=t.length,u=0;r>u;u+=1)p(h,t[u],b),s(h,t[u],b);b.objects=b.objects.concat(t),b.result=b.result.concat(t)}return g.obj(t)&&!g.arr(t)&&(p(h,t,b),s(h,t,b),b.objects.push(t),b.result.push(t)),n&&g.fn(n)&&(n.call(this,b.result),e(b),m=[]),this},get:function(t,n){return b.template=t||{},b.doHashLookup=!0,m.push(r),b.onEnd=n,n&&g.fn(n)&&(f(b,m),e(b),m=[]),this},take:function(t,n){return b.template=t||{},m.push(r),m.push(o),m.push(i),b.onEnd=n,n&&g.fn(n)&&(f(b,m),e(b),m=[]),this},each:function(t){return m.push(c),b.onEach=t,t&&g.fn(t)&&(f(b,m),e(b),m=[]),this},drop:function(t){return b.objects.splice(0,b.objects.length),b.uuids={},t&&g.fn(t)&&(t.call(null),e(b),m=[]),this},destroy:function(t,n){var e=d(t);return t&&g.str(t.name)&&j.storage&&window[e].removeItem(t.name),this.drop(n),this},sort:function(t,n){return b.onEnd=function(){b.result=b.result.sort(function(n,e){var u="",r="";if(g.obj(n)&&g.obj(e)&&n&&e){if(u=n[t],r=e[t],u===r)return n;if(typeof u==typeof r)return r>u?-1:1}})},f(b,m),n&&g.fn(n)&&(n.call(null,b.result),e(b),m=[]),this},save:function(t,n){var u=d(t);return t&&g.str(t.name)&&j.storage&&(b.onEnd=function(){window[u].setItem(t.name,JSON.stringify({creator:t.name,timestamp:+new Date,objects:b.result})),n&&g.fn(n)&&n.call(null,b.result)},n&&g.fn(n)&&(f(b,m),e(b),m=[])),this},load:function(t,n){var e=d(t),u="",r={};return t&&g.str(t.name)&&j.storage&&(u=window[e].getItem(t.name),r=JSON.parse(u)),this.put(g.empty(r)?[]:r.objects,n),this},status:function(t){return t.call(null,{count:b.objects.length,updated:b.updated}),this}}}t.db=function(t){return new n(t)}})("undefined"==typeof exports?this.yocto={}:exports);
//@ sourceMappingURL=build/yocto.min.0.0.1.js.map